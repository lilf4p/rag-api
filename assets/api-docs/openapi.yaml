openapi: 3.1.0
info:
  title: Industry 5.0 RESTful API
  description: |2
     ## Installation
        To install locally the API, clone the repository and install the dependencies using pip:
        ```bash
        git clone https://github.com/sa-team-d/api.git
        cd api
        pip install -r requirements.txt
        ```

        ## Usage
        To start the API locally, run the following command:
        ```bash
        uvicorn main:app --reload
        ```
        or use the FastAPI command for development:
        ```bash
        fastapi dev main.py
        ```
        The API will be available at `http://localhost:8000/api/<api-version>`.

        ## Documentation
        The API documentation is available at `http://localhost:8000/api/<api-version>/docs` as a Swagger UI interface. The documentation provides information about the available endpoints, request and response formats, and examples. For an alternative view, the API documentation is also available at `http://localhost:8000/api/<api-version>/redoc`.

        ## Plugins
        The API is organized in plugins, each containing a set of endpoints related to a specific functionality. The available plugins are:
        - `kpi`: Get all KPIs available, filter KPIs by name, and set thresholds
        - `machine`: Get all machines, filter machines by category, and get machine details
        - `user`: Users management
        - `report`: Generate and manage reports

        ## Contact
        For any questions or issues, please contact the project maintainers:
        - [Leonardo Stoppani](https://github.com/lilf4p)
        - [Oleksiy Nedobiychuk](https://github.com/lesi-nedo)
  version: v1.0
paths:
  /:
    get:
      summary: Redirect to Swagger docs
      operationId: redirect_to_docs__get
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema: {}
  /docs:
    get:
      summary: Redirect to Swagger docs
      operationId: redirect_to_docs_docs_get
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema: {}
  /redoc:
    get:
      summary: Redirect to ReDoc docs
      operationId: redirect_to_redoc_redoc_get
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema: {}
  /api/v1.0/machine/:
    get:
      tags:
      - Machine
      summary: Get all machines in the dataset
      operationId: get_all_machines_api_v1_0_machine__get
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  properties:
                    id:
                      type: string
                      title: Id
                    category:
                      type: string
                      title: Category
                    name:
                      type: string
                      title: Name
                    kpi_list:
                      items:
                        properties:
                          kpi_type:
                            type: string
                            title: Kpi Type
                          data:
                            items:
                              properties:
                                machine_id:
                                  type: string
                                  title: Machine Id
                                sum:
                                  type: number
                                  title: Sum
                                avg:
                                  type: number
                                  title: Avg
                                min:
                                  type: number
                                  title: Min
                                max:
                                  type: number
                                  title: Max
                                var:
                                  type: number
                                  title: Var
                              type: object
                              required:
                              - machine_id
                              - sum
                              - avg
                              - min
                              - max
                              - var
                              title: Value
                            type: array
                            title: Data
                          machine_id:
                            type: string
                            title: Machine Id
                          config:
                            type: object
                            title: Config
                        type: object
                        required:
                        - kpi_type
                        - data
                        - machine_id
                        - config
                        title: Kpi
                      type: array
                      title: Kpi List
                  type: object
                  required:
                  - id
                  - category
                  - name
                  - kpi_list
                  title: Machine
                type: array
                title: Response Get All Machines Api V1 0 Machine  Get
      security:
      - HTTPBearer: []
  /api/v1.0/machine/filter:
    post:
      tags:
      - Machine
      summary: Filter machines by type or name
      operationId: filter_machines_api_v1_0_machine_filter_post
      security:
      - HTTPBearer: []
      parameters:
      - name: machine_name
        in: query
        required: false
        schema:
          type: string
          title: Machine Name
      - name: machine_type
        in: query
        required: false
        schema:
          type: string
          title: Machine Type
      responses:
        "201":
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  properties:
                    id:
                      type: string
                      title: Id
                    category:
                      type: string
                      title: Category
                    name:
                      type: string
                      title: Name
                    kpi_list:
                      items:
                        properties:
                          kpi_type:
                            type: string
                            title: Kpi Type
                          data:
                            items:
                              properties:
                                machine_id:
                                  type: string
                                  title: Machine Id
                                sum:
                                  type: number
                                  title: Sum
                                avg:
                                  type: number
                                  title: Avg
                                min:
                                  type: number
                                  title: Min
                                max:
                                  type: number
                                  title: Max
                                var:
                                  type: number
                                  title: Var
                              type: object
                              required:
                              - machine_id
                              - sum
                              - avg
                              - min
                              - max
                              - var
                              title: Value
                            type: array
                            title: Data
                          machine_id:
                            type: string
                            title: Machine Id
                          config:
                            type: object
                            title: Config
                        type: object
                        required:
                        - kpi_type
                        - data
                        - machine_id
                        - config
                        title: Kpi
                      type: array
                      title: Kpi List
                  type: object
                  required:
                  - id
                  - category
                  - name
                  - kpi_list
                  title: Machine
                title: Response Filter Machines Api V1 0 Machine Filter Post
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                properties:
                  detail:
                    items:
                      properties:
                        loc:
                          items:
                            anyOf:
                            - type: string
                            - type: integer
                          type: array
                          title: Location
                        msg:
                          type: string
                          title: Message
                        type:
                          type: string
                          title: Error Type
                      type: object
                      required:
                      - loc
                      - msg
                      - type
                      title: ValidationError
                    type: array
                    title: Detail
                type: object
                title: HTTPValidationError
  /api/v1.0/machine/{machine_id}:
    get:
      tags:
      - Machine
      summary: Get machine by ID
      operationId: get_machine_by_id_api_v1_0_machine__machine_id__get
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                properties:
                  id:
                    type: string
                    title: Id
                  category:
                    type: string
                    title: Category
                  name:
                    type: string
                    title: Name
                  kpi_list:
                    items:
                      properties:
                        kpi_type:
                          type: string
                          title: Kpi Type
                        data:
                          items:
                            properties:
                              machine_id:
                                type: string
                                title: Machine Id
                              sum:
                                type: number
                                title: Sum
                              avg:
                                type: number
                                title: Avg
                              min:
                                type: number
                                title: Min
                              max:
                                type: number
                                title: Max
                              var:
                                type: number
                                title: Var
                            type: object
                            required:
                            - machine_id
                            - sum
                            - avg
                            - min
                            - max
                            - var
                            title: Value
                          type: array
                          title: Data
                        machine_id:
                          type: string
                          title: Machine Id
                        config:
                          type: object
                          title: Config
                      type: object
                      required:
                      - kpi_type
                      - data
                      - machine_id
                      - config
                      title: Kpi
                    type: array
                    title: Kpi List
                type: object
                required:
                - id
                - category
                - name
                - kpi_list
                title: Machine
      security:
      - HTTPBearer: []
  /api/v1.0/user/login:
    post:
      tags:
      - User
      summary: Authenticate user and get ID token
      description: |-
        TEST ONLY: Authenticate user and get ID token
        Args:
        email (str): User email
        password (str): User password

        Returns:
        dict: ID token if successful, error message otherwise
      operationId: login_api_v1_0_user_login_post
      parameters:
      - name: email
        in: query
        required: true
        schema:
          type: string
          title: Email
      - name: password
        in: query
        required: true
        schema:
          type: string
          title: Password
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                type: object
                title: Response Login Api V1 0 User Login Post
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                properties:
                  detail:
                    items:
                      properties:
                        loc:
                          items:
                            anyOf:
                            - type: string
                            - type: integer
                          type: array
                          title: Location
                        msg:
                          type: string
                          title: Message
                        type:
                          type: string
                          title: Error Type
                      type: object
                      required:
                      - loc
                      - msg
                      - type
                      title: ValidationError
                    type: array
                    title: Detail
                type: object
                title: HTTPValidationError
  /api/v1.0/user/list:
    get:
      tags:
      - User
      summary: List all users
      operationId: list_users_api_v1_0_user_list_get
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  properties:
                    uid:
                      type: string
                      title: Uid
                    email:
                      type: string
                      format: email
                      title: Email
                    site:
                      type: integer
                      title: Site
                    name:
                      type: string
                      title: Name
                    phone_number:
                      type: string
                      title: Phone Number
                  type: object
                  required:
                  - uid
                  - email
                  - site
                  - name
                  - phone_number
                  title: User
                type: array
                title: Response List Users Api V1 0 User List Get
      security:
      - HTTPBearer: []
  /api/v1.0/user/:
    get:
      tags:
      - User
      summary: Get current user
      operationId: get_current_user_api_v1_0_user__get
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                properties:
                  uid:
                    type: string
                    title: Uid
                  email:
                    type: string
                    format: email
                    title: Email
                  site:
                    type: integer
                    title: Site
                  name:
                    type: string
                    title: Name
                  phone_number:
                    type: string
                    title: Phone Number
                type: object
                required:
                - uid
                - email
                - site
                - name
                - phone_number
                title: User
      security:
      - HTTPBearer: []
  /api/v1.0/user/filter:
    post:
      tags:
      - User
      summary: Filter users by name or email
      operationId: filter_users_api_v1_0_user_filter_post
      security:
      - HTTPBearer: []
      parameters:
      - name: first_name
        in: query
        required: false
        schema:
          type: string
          title: First Name
      - name: last_name
        in: query
        required: false
        schema:
          type: string
          title: Last Name
      - name: email
        in: query
        required: false
        schema:
          type: string
          title: Email
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  properties:
                    uid:
                      type: string
                      title: Uid
                    email:
                      type: string
                      format: email
                      title: Email
                    site:
                      type: integer
                      title: Site
                    name:
                      type: string
                      title: Name
                    phone_number:
                      type: string
                      title: Phone Number
                  type: object
                  required:
                  - uid
                  - email
                  - site
                  - name
                  - phone_number
                  title: User
                title: Response Filter Users Api V1 0 User Filter Post
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                properties:
                  detail:
                    items:
                      properties:
                        loc:
                          items:
                            anyOf:
                            - type: string
                            - type: integer
                          type: array
                          title: Location
                        msg:
                          type: string
                          title: Message
                        type:
                          type: string
                          title: Error Type
                      type: object
                      required:
                      - loc
                      - msg
                      - type
                      title: ValidationError
                    type: array
                    title: Detail
                type: object
                title: HTTPValidationError
  /api/v1.0/kpi/:
    get:
      tags:
      - KPI
      summary: Get all KPIs avaiable
      operationId: get_all_kpis_api_v1_0_kpi__get
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  properties:
                    name:
                      type: string
                      title: Name
                    kpi_list:
                      items:
                        properties:
                          kpi_type:
                            type: string
                            title: Kpi Type
                          data:
                            items:
                              properties:
                                machine_id:
                                  type: string
                                  title: Machine Id
                                sum:
                                  type: number
                                  title: Sum
                                avg:
                                  type: number
                                  title: Avg
                                min:
                                  type: number
                                  title: Min
                                max:
                                  type: number
                                  title: Max
                                var:
                                  type: number
                                  title: Var
                              type: object
                              required:
                              - machine_id
                              - sum
                              - avg
                              - min
                              - max
                              - var
                              title: Value
                            type: array
                            title: Data
                          machine_id:
                            type: string
                            title: Machine Id
                          config:
                            type: object
                            title: Config
                        type: object
                        required:
                        - kpi_type
                        - data
                        - machine_id
                        - config
                        title: Kpi
                      type: array
                      title: Kpi List
                  type: object
                  required:
                  - name
                  - kpi_list
                  title: KPIGroup
                type: array
                title: Response Get All Kpis Api V1 0 Kpi  Get
      security:
      - HTTPBearer: []
  /api/v1.0/kpi/filter:
    get:
      tags:
      - KPI
      summary: Get all KPIs with a name
      operationId: get_kpis_by_group_api_v1_0_kpi_filter_get
      security:
      - HTTPBearer: []
      parameters:
      - name: kpi_name
        in: query
        required: true
        schema:
          type: string
          title: Kpi Name
      - name: start_date
        in: query
        required: true
        schema:
          type: string
          title: Start Date
      - name: end_date
        in: query
        required: true
        schema:
          type: string
          title: End Date
      - name: site_name
        in: query
        required: false
        schema:
          type: string
          title: Site Name
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  properties:
                    kpi_type:
                      type: string
                      title: Kpi Type
                    data:
                      items:
                        properties:
                          machine_id:
                            type: string
                            title: Machine Id
                          sum:
                            type: number
                            title: Sum
                          avg:
                            type: number
                            title: Avg
                          min:
                            type: number
                            title: Min
                          max:
                            type: number
                            title: Max
                          var:
                            type: number
                            title: Var
                        type: object
                        required:
                        - machine_id
                        - sum
                        - avg
                        - min
                        - max
                        - var
                        title: Value
                      type: array
                      title: Data
                    machine_id:
                      type: string
                      title: Machine Id
                    config:
                      type: object
                      title: Config
                  type: object
                  required:
                  - kpi_type
                  - data
                  - machine_id
                  - config
                  title: Kpi
                title: Response Get Kpis By Group Api V1 0 Kpi Filter Get
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                properties:
                  detail:
                    items:
                      properties:
                        loc:
                          items:
                            anyOf:
                            - type: string
                            - type: integer
                          type: array
                          title: Location
                        msg:
                          type: string
                          title: Message
                        type:
                          type: string
                          title: Error Type
                      type: object
                      required:
                      - loc
                      - msg
                      - type
                      title: ValidationError
                    type: array
                    title: Detail
                type: object
                title: HTTPValidationError
  /api/v1.0/kpi/threshold/:
    post:
      tags:
      - KPI
      summary: Set threshold for a KPI
      operationId: set_threshold_api_v1_0_kpi_threshold__post
      parameters:
      - name: kpi_name
        in: query
        required: true
        schema:
          type: string
          title: Kpi Name
      - name: threshold
        in: query
        required: true
        schema:
          type: number
          title: Threshold
      responses:
        "201":
          description: Successful Response
          content:
            application/json:
              schema: {}
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                properties:
                  detail:
                    items:
                      properties:
                        loc:
                          items:
                            anyOf:
                            - type: string
                            - type: integer
                          type: array
                          title: Location
                        msg:
                          type: string
                          title: Message
                        type:
                          type: string
                          title: Error Type
                      type: object
                      required:
                      - loc
                      - msg
                      - type
                      title: ValidationError
                    type: array
                    title: Detail
                type: object
                title: HTTPValidationError
  /api/v1.0/report/:
    post:
      tags:
      - Report
      summary: "Create a new report, save it to the database and return it"
      operationId: create_report_api_v1_0_report__post
      security:
      - HTTPBearer: []
      parameters:
      - name: name
        in: query
        required: true
        schema:
          type: string
          title: Name
      - name: site
        in: query
        required: true
        schema:
          type: string
          title: Site
      - name: kpi
        in: query
        required: true
        schema:
          type: string
          title: Kpi
      - name: frequency
        in: query
        required: true
        schema:
          type: string
          title: Frequency
      responses:
        "201":
          description: Successful Response
          content:
            application/json:
              schema:
                properties:
                  id:
                    type: string
                    title: Id
                  kpi_type:
                    type: string
                    title: Kpi Type
                  content:
                    type: string
                    title: Content
                  date:
                    type: string
                    format: date-time
                    title: Date
                  uid:
                    type: string
                    title: Uid
                type: object
                required:
                - id
                - kpi_type
                - content
                - date
                - uid
                title: Report
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                properties:
                  detail:
                    items:
                      properties:
                        loc:
                          items:
                            anyOf:
                            - type: string
                            - type: integer
                          type: array
                          title: Location
                        msg:
                          type: string
                          title: Message
                        type:
                          type: string
                          title: Error Type
                      type: object
                      required:
                      - loc
                      - msg
                      - type
                      title: ValidationError
                    type: array
                    title: Detail
                type: object
                title: HTTPValidationError
    get:
      tags:
      - Report
      summary: Get all reports created by the user
      operationId: get_all_reports_api_v1_0_report__get
      parameters:
      - name: site
        in: query
        required: true
        schema:
          type: string
          title: Site
      - name: required_role
        in: query
        required: true
        schema:
          type: string
          title: Required Role
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  properties:
                    id:
                      type: string
                      title: Id
                    kpi_type:
                      type: string
                      title: Kpi Type
                    content:
                      type: string
                      title: Content
                    date:
                      type: string
                      format: date-time
                      title: Date
                    uid:
                      type: string
                      title: Uid
                  type: object
                  required:
                  - id
                  - kpi_type
                  - content
                  - date
                  - uid
                  title: Report
                title: Response Get All Reports Api V1 0 Report  Get
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                properties:
                  detail:
                    items:
                      properties:
                        loc:
                          items:
                            anyOf:
                            - type: string
                            - type: integer
                          type: array
                          title: Location
                        msg:
                          type: string
                          title: Message
                        type:
                          type: string
                          title: Error Type
                      type: object
                      required:
                      - loc
                      - msg
                      - type
                      title: ValidationError
                    type: array
                    title: Detail
                type: object
                title: HTTPValidationError
  /api/v1.0/report/filter:
    get:
      tags:
      - Report
      summary: Get all reports for a specific site created by the user
      operationId: get_reports_by_site_api_v1_0_report_filter_get
      security:
      - HTTPBearer: []
      parameters:
      - name: site
        in: query
        required: true
        schema:
          type: string
          title: Site
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  properties:
                    id:
                      type: string
                      title: Id
                    kpi_type:
                      type: string
                      title: Kpi Type
                    content:
                      type: string
                      title: Content
                    date:
                      type: string
                      format: date-time
                      title: Date
                    uid:
                      type: string
                      title: Uid
                  type: object
                  required:
                  - id
                  - kpi_type
                  - content
                  - date
                  - uid
                  title: Report
                title: Response Get Reports By Site Api V1 0 Report Filter Get
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                properties:
                  detail:
                    items:
                      properties:
                        loc:
                          items:
                            anyOf:
                            - type: string
                            - type: integer
                          type: array
                          title: Location
                        msg:
                          type: string
                          title: Message
                        type:
                          type: string
                          title: Error Type
                      type: object
                      required:
                      - loc
                      - msg
                      - type
                      title: ValidationError
                    type: array
                    title: Detail
                type: object
                title: HTTPValidationError
components:
  schemas:
    HTTPValidationError:
      properties:
        detail:
          items:
            properties:
              loc:
                items:
                  anyOf:
                  - type: string
                  - type: integer
                type: array
                title: Location
              msg:
                type: string
                title: Message
              type:
                type: string
                title: Error Type
            type: object
            required:
            - loc
            - msg
            - type
            title: ValidationError
          type: array
          title: Detail
      type: object
      title: HTTPValidationError
    KPIGroup:
      properties:
        name:
          type: string
          title: Name
        kpi_list:
          items:
            properties:
              kpi_type:
                type: string
                title: Kpi Type
              data:
                items:
                  properties:
                    machine_id:
                      type: string
                      title: Machine Id
                    sum:
                      type: number
                      title: Sum
                    avg:
                      type: number
                      title: Avg
                    min:
                      type: number
                      title: Min
                    max:
                      type: number
                      title: Max
                    var:
                      type: number
                      title: Var
                  type: object
                  required:
                  - machine_id
                  - sum
                  - avg
                  - min
                  - max
                  - var
                  title: Value
                type: array
                title: Data
              machine_id:
                type: string
                title: Machine Id
              config:
                type: object
                title: Config
            type: object
            required:
            - kpi_type
            - data
            - machine_id
            - config
            title: Kpi
          type: array
          title: Kpi List
      type: object
      required:
      - name
      - kpi_list
      title: KPIGroup
    Kpi:
      properties:
        kpi_type:
          type: string
          title: Kpi Type
        data:
          items:
            properties:
              machine_id:
                type: string
                title: Machine Id
              sum:
                type: number
                title: Sum
              avg:
                type: number
                title: Avg
              min:
                type: number
                title: Min
              max:
                type: number
                title: Max
              var:
                type: number
                title: Var
            type: object
            required:
            - machine_id
            - sum
            - avg
            - min
            - max
            - var
            title: Value
          type: array
          title: Data
        machine_id:
          type: string
          title: Machine Id
        config:
          type: object
          title: Config
      type: object
      required:
      - kpi_type
      - data
      - machine_id
      - config
      title: Kpi
    Machine:
      properties:
        id:
          type: string
          title: Id
        category:
          type: string
          title: Category
        name:
          type: string
          title: Name
        kpi_list:
          items:
            properties:
              kpi_type:
                type: string
                title: Kpi Type
              data:
                items:
                  properties:
                    machine_id:
                      type: string
                      title: Machine Id
                    sum:
                      type: number
                      title: Sum
                    avg:
                      type: number
                      title: Avg
                    min:
                      type: number
                      title: Min
                    max:
                      type: number
                      title: Max
                    var:
                      type: number
                      title: Var
                  type: object
                  required:
                  - machine_id
                  - sum
                  - avg
                  - min
                  - max
                  - var
                  title: Value
                type: array
                title: Data
              machine_id:
                type: string
                title: Machine Id
              config:
                type: object
                title: Config
            type: object
            required:
            - kpi_type
            - data
            - machine_id
            - config
            title: Kpi
          type: array
          title: Kpi List
      type: object
      required:
      - id
      - category
      - name
      - kpi_list
      title: Machine
    Report:
      properties:
        id:
          type: string
          title: Id
        kpi_type:
          type: string
          title: Kpi Type
        content:
          type: string
          title: Content
        date:
          type: string
          format: date-time
          title: Date
        uid:
          type: string
          title: Uid
      type: object
      required:
      - id
      - kpi_type
      - content
      - date
      - uid
      title: Report
    User:
      properties:
        uid:
          type: string
          title: Uid
        email:
          type: string
          format: email
          title: Email
        site:
          type: integer
          title: Site
        name:
          type: string
          title: Name
        phone_number:
          type: string
          title: Phone Number
      type: object
      required:
      - uid
      - email
      - site
      - name
      - phone_number
      title: User
    ValidationError:
      properties:
        loc:
          items:
            anyOf:
            - type: string
            - type: integer
          type: array
          title: Location
        msg:
          type: string
          title: Message
        type:
          type: string
          title: Error Type
      type: object
      required:
      - loc
      - msg
      - type
      title: ValidationError
    Value:
      properties:
        machine_id:
          type: string
          title: Machine Id
        sum:
          type: number
          title: Sum
        avg:
          type: number
          title: Avg
        min:
          type: number
          title: Min
        max:
          type: number
          title: Max
        var:
          type: number
          title: Var
      type: object
      required:
      - machine_id
      - sum
      - avg
      - min
      - max
      - var
      title: Value
  securitySchemes:
    HTTPBearer:
      type: http
      scheme: bearer
